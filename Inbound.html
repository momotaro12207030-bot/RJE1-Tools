<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>HC計算ツール</title>
<link rel="icon" type="image/png" href="favicon-rje1.png">
<style>
body {
  font-family: sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 20px;
}
.container {
  max-width: 900px;
  margin: auto;
}
.grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
}
.card {
  background: white;
  padding: 15px;
  border-radius: 10px;
  border-left: 8px solid;
}
input {
  width: 100%;
  padding: 6px;
  margin-bottom: 6px;
}
.result {
  font-size: 18px;
  font-weight: bold;
}
.summary {
  margin-top: 20px;
  padding: 15px;
  background: #222;
  color: white;
  border-radius: 10px;
  font-size: 20px;
}
.negative {
  color: #ff4d4d;
}
@media(max-width:700px){
  .grid {
    grid-template-columns: 1fr;
  }
}
</style>
</head>
<body>
<div class="container">
  <h1>HC計算ツール</h1>

  出勤HC（人数）:
  <input type="number" id="shiftHC" value="0">

  <div class="grid" id="cards"></div>

  <div class="summary" id="summary">
    合計LH: 0h<br>
    合計HC: 0人<br>
    不足LH: 0h<br>
    不足HC: 0人
  </div>
</div>

<script>
const processes = [
  {name:"Check In", color:"#3498db"},
  {name:"IDRT", color:"#2ecc71"},
  {name:"Case Stow", color:"#f39c12"},
  {name:"Case Receive", color:"#e74c3c"}
];

const container = document.getElementById("cards");

processes.forEach((p,i)=>{
  const card = document.createElement("div");
  card.className = "card";
  card.style.borderColor = p.color;

  card.innerHTML = `
    <h2>${p.name}</h2>
    FCST:<br><input type="number" id="fcst${i}" value="0">
    Backlog:<br><input type="number" id="backlog${i}" value="0">
    能力(ケース/時):<br><input type="number" id="rate${i}" value="1">
    <div class="result" id="res${i}">
      LH: 0h<br>
      HC: 0人
    </div>
  `;
  container.appendChild(card);

  ["fcst","backlog","rate"].forEach(id=>{
    card.querySelector(`#${id}${i}`).addEventListener("input", calc);
  });
});

document.getElementById("shiftHC").addEventListener("input", calc);

function formatValue(value, unit){
  if(value < 0){
    return `<span class="negative">${value.toFixed(2)}${unit}</span>`;
  }
  return `${value.toFixed(2)}${unit}`;
}

function calc(){
  let totalLH = 0;
  let totalHC = 0;

  processes.forEach((p,i)=>{
    const fcst = Number(document.getElementById(`fcst${i}`).value);
    const backlog = Number(document.getElementById(`backlog${i}`).value);
    const rate = Number(document.getElementById(`rate${i}`).value);

    let lh = 0;
    if(rate > 0){
      lh = (fcst + backlog) / rate;
    }
    const hc = lh / 8;

    totalLH += lh;
    totalHC += hc;

    document.getElementById(`res${i}`).innerHTML =
      `LH: ${formatValue(lh,"h")}<br>
       HC: ${formatValue(hc,"人")}`;
  });

  const shiftHC = Number(document.getElementById("shiftHC").value);
  const availableLH = shiftHC * 8;

  const diffLH = availableLH - totalLH;
  const diffHC = shiftHC - totalHC;

  document.getElementById("summary").innerHTML =
    `合計LH: ${formatValue(totalLH,"h")}<br>
     合計HC: ${formatValue(totalHC,"人")}<br>
     不足LH: ${formatValue(diffLH,"h")}<br>
     不足HC: ${formatValue(diffHC,"人")}`;
}

calc();
</script>
</body>
</html>

